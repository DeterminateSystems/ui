import type { FC } from "react";

import "./index.scss";
import Link from "../Link";

export type VulnerabilityPropertiesProps = {
  cve_ids?: string[];
  references?: string[];
};

const VulnerabilityProperties: FC<VulnerabilityPropertiesProps> = ({
  cve_ids,
  references,
}) => (
  <VulnerabilityPropertyContainer>
    {cve_ids != undefined && cve_ids.length > 0 && (
      <VulnerabilityCVEProperty ids={cve_ids} />
    )}
    {references != undefined && references.length > 0 && (
      <VulnerabilityReferencesProperty urls={references} />
    )}
  </VulnerabilityPropertyContainer>
);

const VulnerabilityPropertyContainer: FC<React.PropsWithChildren> = ({
  children,
}) => <dl className="vulnerability-properties">{children}</dl>;

const VulnerabilityCVEProperty: FC<{ ids: string[] }> = ({ ids }) => (
  <>
    <dt>Related CVEs</dt>
    {ids.map((id) => (
      <dd>{id}</dd>
    ))}
  </>
);

const VulnerabilityReferencesProperty: FC<{ urls: string[] }> = ({ urls }) => (
  <>
    <dt>External references</dt>
    {urls.map((url) => (
      <dd className="vulnerability-references-property--url">
        <Link href={url}>{url}</Link>
      </dd>
    ))}
  </>
);

export default VulnerabilityProperties;
